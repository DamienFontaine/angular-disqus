/* 
 * angular-disqus 1.0.0
 * http://github.com/kirstein/angular-disqus
 * 
 * Licensed under the MIT license
 */
(function(e,t){"use strict";var i=e.module("ngDisqus",[]);i.provider("$disqus",function(){function i(){return document.getElementsByTagName("head")[0]||document.getElementsByTagName("body")[0]}function n(){return a||t.disqus_shortname}function r(e){return"//"+e+".disqus.com/embed.js"}function s(e){var t=document.createElement("script");return t.type="text/javascript",t.async=!0,t.src=r(e),t}function u(e,t){var i,n,s=e.getElementsByTagName("script"),u=r(t);for(n=0;s.length>n;n+=1)if(i=s[n],i.src.indexOf(u))return!0;return!1}function o(e,i,n){t.disqus_identifier=e,t.disqus_url=i,t.disqus_shortname=n}function d(e){t.DISQUS.reset({reload:!0,config:function(){this.page.identifier=e,this.page.url=$location.absUrl()}})}function c(e,t){var r=n(),d=i();u(d,r)||(o(t,e.absUrl(),r),d.appendChild(s(r)))}var a;this.setShortname=function(e){a=e},this.$get=["$location",function(i){function r(r){if(!e.isDefined(n()))throw Error("No disqus shortname defined");if(!e.isDefined(r))throw Error("No disqus thread id defined");e.isDefined(t.DISQUS)?d(r):c(i,r)}return{commit:r,getShortname:n}}]}),i.directive("disqus",["$disqus",function(t){return{restrict:"EA",replace:!0,template:'<div id="disqus_thread"></div>',link:function(i,n,r){i.$watch(r.disqus,function(i){e.isDefined(i)&&t.commit(i)})}}}])})(angular,this);